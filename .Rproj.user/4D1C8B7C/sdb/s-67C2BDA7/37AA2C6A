{
    "contents" : "# Author: Brian Waismeyer\n# Contact: bwaismeyer@gmail.com\n\n# Date created: 3/23/2015\n# Date updated: 7/8/2015\n\n###############################################################################\n## SCRIPT OVERVIEW\n\n# GOAL: ui.R is a core Shiny project file that defines and arranges the \n#       interface features for interacting with Shiny data objects (defined\n#       in server.R).\n#\n#       For the Multinomial Outcome Simulator (MOS) application, the ui.R file\n#       also handles loading any R resources needed by ui.R and server.R, along\n#       with the relevant config file (MOS_config.R) to load the base \n#       data, base formula, and variable configuration list needed for the MOS \n#       application to function correctly.\n\n# SCRIPT OUTLINE:\n# - Load Supporting Packages and Scripts\n#   - ui.R is run before server.R, so it makes sense to load any resources \n#     needed for either script here.\n#   - We also make sure Shiny uses Cairo here.\n#\n# - Load MOS Configuration Script\n#   - This it is the place where the application adminstrator defines:\n#     (a) what data will be used by the MOS\n#     (b) the formula relating predictor attributes to the outcome attribute\n#     (c) which variables will be visible in the UI, how they can be \n#         interacted with (slider or facet), and how they should be\n#         understood by users\n#     (d) (optional) custom visualization colors\n#     (e) (optional) custom bootstrap.css file to format the application\n#\n# - Define Visualization Theme\n#   - Common ggplot theme settings are collected into a custom theme that can\n#     be layered on top of plots for a consistent look across the application.\n#\n# - Process the Variable Configuration List\n#   - Key MOS configuration features are processed so they are ready to be used \n#     with the Shiny UI Loop and the simulation/visualization functions.\n#\n# - Shiny UI Loop\n#   - Global Application Settings\n#   - Ribbon Plot UI and Visualization (\"Explore Mode\")\n#   - Dot Cloud Plot UI and Visualization (\"Single Case Mode\")\n\n###############################################################################\n## Load Supporting Packages and Scripts\n\n# all the supporting packages and scripts for this project are defined in a\n# single script for consistency/clarity\nsource(\"MOS_packages_and_custom_functions.R\")\n\n# insure that Shiny makes use of Cairo\noptions(shiny.usecairo=T)\n\n###############################################################################\n## Load MOS Configuration Script\n\nsource(\"MOS_config.R\")\n\n###############################################################################\n## Define Visualization Theme\n\n# define the visualization theme to be applied to all plots for a consistent\n# style\nMOS_theme <<- theme_bw(16) +\n    theme(panel.grid.minor = element_blank(), \n          panel.grid.major = element_blank(),\n          strip.text = element_text(color = \"white\"),\n          axis.text = element_text(size = 12),\n          axis.title.x = element_text(vjust = -2),\n          axis.title.y = element_text(vjust = 3),\n          plot.margin = grid::unit(c(1, 1, 1, 1), \"cm\"),\n          plot.title = element_text(vjust = 3, face = \"bold\"),\n          aspect.ratio = 2 / (1 + sqrt(5)),\n          strip.background = element_rect(color = \"#10475B\", fill = \"#10475B\"),\n          panel.border = element_rect(color = \"#10475B\"),\n          axis.ticks = element_line(color = \"#10475B\")\n    )\n\n###############################################################################\n## Process the Variable Configuration List\n\n# use base data to expand variable_configuration to have all features/values \n# needed to define user inputs\nvariable_configuration <<- add_input_features(variable_configuration,\n                                              base_data)\n\n# extract the fixed UI options from the variable configuration list\nfixed_ui_options <<- get_fixed_ui_options(variable_configuration)\n\n# create a simple collection of raw = pretty name pairs (to make it easy to\n# associate the pairs)\nraw_pretty_pairs <<- do.call(rbind, variable_configuration)\nraw_pretty_pairs <<- as.data.frame(raw_pretty_pairs)$pretty_name\n\n###############################################################################\n## SHINY UI LOOP\n\nshinyUI(navbarPage(\n    # global application settings\n    MOS_instance_name,\n    \n    footer = HTML(footer_text),\n    \n    # using MOS to explore trends per predictor (\"Explore Mode\")\n    tabPanel(\"Explore Mode\", fluidPage(\n        # set custom bootstrap.css if desired/available\n        # you can specify multiple css files here if desired (e.g., to load\n        # a small custom .css file to override some bootstrap behavior)\n        # this adjusts BOTH modes even though it only occurs in the \"Explore\n        # Mode\" section\n        tags$head(\n            tags$link(rel = \"stylesheet\", type = \"text/css\", \n                      href = custom_css),\n            tags$link(rel = \"stylesheet\", type = \"text/css\", \n                      href = \"custom.css\")\n            \n        ),\n        \n        # define user tools in the first column\n        # width = 3 of 12 (Shiny divides the horizontal space up into 12 sections)\n        column(3, \n               bsCollapse(id = \"explore_panels\",\n                          multiple = TRUE,\n                          \n                          bsCollapsePanel(\n                              \"Select X-Axis\",\n                              \n                              radioButtons(\"x_axis_choice\", \n                                           label = NULL, \n                                           choices = fixed_ui_options$x_axis_options)\n                          ),\n                          \n                          bsCollapsePanel(\n                              \"Compare By...\",\n                              \n                              radioButtons(\"facet_choice\", \n                                           label = NULL,\n                                           choices = c(\"No Comparison Selected\", \n                                                       fixed_ui_options$facet_options))\n                          )\n               ),\n               \n               bsCollapse(id = \"adv_options\",         \n                          bsCollapsePanel( \n                              \"Advanced Options\",\n                              \n                              # button that will apply the slider values (i.e., \n                              # will re-run the simulation with current values)\n                              bsButton(\"update_explore_cf_cases\",\n                                       \"Apply Slider Values\",\n                                       block = TRUE,\n                                       style = \"danger\"),\n                              # button that will reset the values to their defaults (i.e.,\n                              # to the median values in the base data set)\n                              bsButton(\"reset_explore_inputs\",\n                                       \"Reset\",\n                                       block = TRUE,\n                                       style = \"warning\"),\n                              br(),\n                              br(),\n                              \n                              uiOutput(\"explore_slider_set\"),\n                              br(),\n                              \n                              actionLink(\"advanced_options_link\",\n                                         \"What do Advanced Options do?\")\n                          )\n               )\n        ),\n        \n        # define the visualization in the second column\n        # width = 9 of 12\n        column(9, \n               plotOutput(\"ribbon_plot\"),\n               \n               uiOutput(\"ribbon_text\"),\n               HTML(ribbon_addendum),\n               \n               bsModal(\"advanced_options_description\",\n                       \"What do 'Advanced Options' do?\",\n                       \"advanced_options_link\",\n                       HTML(paste0(\"In the default view, when you select \",\n                                   \"an x-axis variable the unselected \",\n                                   \"variables are set to a reasonable \",\n                                   \"value for you. Basically, we \",\n                                   \"say: 'If we didn't know these values \",\n                                   \"for a particular case, what would be \",\n                                   \"the most appropriate guess to make?' \",\n                                   \"We use the median values observed \",\n                                   \"in our source data to set the \",\n                                   \"values for the unselected \",\n                                   \"variables.<br><br>\",\n                                   \"Advanced Options allows you to set \",\n                                   \"the unselected x-axis variables to \",\n                                   \"values of your choosing.<br><br>\",\n                                   \"This can be used to explore how the \",\n                                   \"observed relationship between the \",\n                                   \"selected x-axis variable and the \",\n                                   \"simulated case outcomes changes \",\n                                   \"dependent on the context of the other \",\n                                   \"variables.<br><br>\",\n                                   \"More technically, this allows you to \",\n                                   \"explore possible interactions among \",\n                                   \"the predictor variables. For the \",\n                                   \"interested reader, a simple, solid \",\n                                   \"tutorial on interactions is available \",\n                                   \"<a href=\\\"https://cdn1.sph.harvard.edu/wp-content/uploads/sites/603/2013/03/InteractionTutorial.pdf\\\">\",\n                                   \"here</a>.\"\n                       )),\n                       size = \"large\")\n        )\n    )),\n    \n    # using MOS to simulate outcomes for fixed predictor values (\"Single Case \n    # Mode\")\n    tabPanel(\"Single Case Mode\", fluidPage(\n        # define user tools in the first column\n        column(3,\n               # button that will apply the slider/dropdown values (i.e., \n               # will re-run the simulation with current values)\n               bsButton(\"update_sc_cf_cases\",\n                        \"Describe a Case\",\n                        block = TRUE,\n                        disabled = TRUE,\n                        style = \"danger\"),\n               # button that will reset the values to their defaults (i.e.,\n               # to the median values in the base data set)\n               bsButton(\"reset_sc_inputs\",\n                        \"Reset\",\n                        block = TRUE,\n                        style = \"warning\"),\n               br(),\n               bsCollapse(id = \"sc_panels\",\n                          multiple = TRUE,\n                          \n                   bsCollapsePanel(\n                       \"Numeric Features\",\n                       \n                       uiOutput(\"sc_slider_set\")\n                   ),\n                   \n                   bsCollapsePanel(\n                       \"Categorical Features\",\n                       \n                       uiOutput(\"sc_dropdown_set\")\n                   )\n               )\n        ),\n        \n        # define the visualization in the second column\n        column(9,\n               plotOutput(\"dot_cloud_plot\"),\n               \n               HTML(dot_cloud_addendum)\n        )\n    )),\n    \n    # an \"About\" section where additional information can be provided about\n    # the application instance\n    tabPanel(about_title, fluidPage(\n        column(8, offset = 2,\n               \n               HTML(about_body)\n        )\n    ))\n))\n\n###############################################################################\n## END OF SCRIPT\n###############################################################################",
    "created" : 1441218721801.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3275071029",
    "id" : "37AA2C6A",
    "lastKnownWriteTime" : 1436380226,
    "path" : "C:/Projects/COS/ui.R",
    "project_path" : "ui.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}